<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>日程添加</title>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="bootstrap-3.3.7-dist/css/bootstrap.min.css">
    <style>
        #choice{
            margin-left: 30%;
            margin-bottom: 30px;
        }
        #content{
            margin-top: 100px;
        }
        #scheduleForm{
            margin: 0 auto;
            width: 500px;
        }
    </style>
</head>
<body>
    <div id="content">
        <div id="choice">
            <button type="button" onclick="location.href='schedule-list.html'" class="btn btn-primary">
                <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
                返回列表
            </button>
        </div>
        <form id="scheduleForm">
            <div class="form-group">
                <label for="scheduleName">日程名称</label>
                <input type="text" name="scheduleName" class="form-control" id="scheduleName" placeholder="请输入名称" required>
            </div>
            <div class="form-group">
                <label for="scheduleAddr">日程地点</label>
                <input type="text" name="scheduleAddr" class="form-control" id="scheduleAddr" placeholder="请输入地点" required>
            </div>
            <div class="form-group">
                <label for="scheduleTime">日程时间</label>
                <input type="text" name="scheduleTime" class="form-control" id="scheduleTime" placeholder="请输入时间" required>
            </div>
            <span class="btn btn-success" onclick="submit()">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                提交
            </span>
        </form>
    </div>
    <script src="js/global.js"></script>
    <script>
        function checkScheduleName(){
            var flag = true;
            $.ajax({
                async: false,
                type: "get",
                url: rootPath + "/schedule/checkScheduleName/"+$("#scheduleName").val(),
                dataType: "json",
                success: function (result) {
                    if (result.code == 404){
                        flag = false;
                    }
                }
            });
            return flag;
        }
        function submit() {
            if (checkScheduleName()){
                alert("日程名称重复，无法添加!");
                return;
            }
            $.ajax({
                async: false,
                type: "post",
                data: $("#scheduleForm").serialize(),
                url: rootPath + "/schedule",
                dataType: "json",
                success: function (result) {
                    if (result.code == 200){
                        alert("添加成功!");
                        clearInput();
                    }else {
                        alert("添加失败!");
                    }
                }
            });
        }
        function clearInput() {
            $("input[type='text']").each(function (index, obj) {
               $(obj).val("");
            });
        }
    </script>
</body>
</html>